<!DOCTYPE html>
<html>

<head>
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
</head>

<body>
    <h3>Rendered component</h3>
    <div style="width: 100%; height: 300px; background-color: #fafafa; border: 1px solid #e4e4e4;">
        <iframe id="sb-target" style="width: 100%; height: 100%; background-color: transparent"></iframe>
    </div>
    <div style="display: flex; flex-direction: row; height: 600px; width: 100%;">
        <div style="flex: 1; flex-basis: 100%;margin: 16px">
            <h3>Package.json configuration</h3>
            <textarea id="package" style="width: 100%; height: 100%; background-color: #fafafa; border: 1px solid #e4e4e4; padding: 16px;">
                {
                    "name": "supernova-live-react",
                    "version": "1.0.0",
                    "description": "React Template",
                    "keywords": ["react", "supernova"],
                    "main": "src/index.js",
                    "dependencies": {
                        "react-dom": "latest",
                        "react": "latest",
                        "@mui/material": "latest",
                        "@mui/icons-material": "latest",
                        "@emotion/styled": "latest",
                        "@emotion/react": "latest"
                    },
                    "devDependencies": {
                        "@babel/runtime": "7.13.8",
                        "typescript": "4.1.3"
                    },
                    "scripts": {
                        "start": "react-scripts start",
                        "build": "react-scripts build",
                        "test": "react-scripts test --env=jsdom",
                        "eject": "react-scripts eject"
                    },
                    "browserslist": [">0.2%", "not dead", "not ie <= 11", "not op_mini all"]
                }
            </textarea>
        </div>
        <div style="flex: 1; flex-basis: 100%; margin: 16px">
            <h3>Code to render</h3>
            <textarea id="code" style="width: 100%; height: 100%; background-color: #fafafa; border: 1px solid #e4e4e4; padding: 16px;">
                import React from "react";
                import Stack from '@mui/material/Stack';
                import IconButton from '@mui/material/IconButton';
                import DeleteIcon from '@mui/icons-material/Delete';
        
                export default function IconButtonSizes() {
                return (
                    <Stack direction="row" alignItems="center" spacing={1}>
                    <IconButton aria-label="delete" size="small">
                        <DeleteIcon fontSize="inherit" />
                    </IconButton>
                    <IconButton aria-label="delete" size="small">
                        <DeleteIcon fontSize="small" />
                    </IconButton>
                    <IconButton aria-label="delete" size="large">
                        <DeleteIcon />
                    </IconButton>
                    <IconButton aria-label="delete" size="large">
                        <DeleteIcon fontSize="inherit" />
                    </IconButton>
                    </Stack>
                );
                }
            </textarea>
        </div>
    </div>

    <script src="rtcp-core.js"></script>
    <script>
        // Create sandbox
        const SandboxRenderer = window.sandboxRenderer;
        const rendererInstance = new SandboxRenderer()

        const code = document.getElementById("code").value
        const package = document.getElementById("package").value

        const encodedData = rendererInstance.encodeReactSandboxData(code, package);
        rendererInstance.injectSandboxDataToTarget("sb-target", encodedData)
        rendererInstance.buildSandboxesForTargetsWithIDStartingWith("sb-target")
    </script>
</body>

</html>